<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Dashboard bota</title>
  <style>
    html, body { margin:0; padding:0; background:#eef4fc; font-family:'Segoe UI',sans-serif; color:#333; }
    .container { max-width:900px; margin:30px auto; background:#fff; padding:20px; border-radius:8px; box-shadow:0 2px 8px rgba(0,0,0,0.1); }
    h1,h2 { color:#2c3e50; }
    h2 { margin-top:30px; border-bottom:1px solid #ddd; padding-bottom:5px; }
    ul { list-style:none; padding:0; }
    li { margin:4px 0; }
    table { width:100%; border-collapse:collapse; margin-top:15px; }
    th, td { border:1px solid #ccc; padding:6px; text-align:center; }
    th { background:#2c3e50; color:#fff; }
    tr:nth-child(even) { background:#f9f9f9; }
    #toggle-dark { position:fixed; top:10px; right:10px; padding:6px 10px; background:#2c3e50; color:#fff; border:none; border-radius:4px; cursor:pointer; z-index:1; }
    #city-input { padding:5px; border:1px solid #ccc; border-radius:4px; width:200px; }
    button#city-btn { padding:6px 10px; border:none; border-radius:4px; background:#2c3e50; color:#fff; cursor:pointer; }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css"/>
  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
</head>
<body>
  <button id="toggle-dark">ðŸŒ“</button>
  <div class="container">
    <h1>Dashboard bota</h1>
    <p><em>Ostatni pomiar: 2025-04-22 19:49:49</em></p>

    <h2>Pogoda</h2>
    <ul><li><strong>Warsaw:</strong> Warsaw: +19Â°C</li>
<li><strong>KrakÃ³w:</strong> Krakow: +20Â°C</li>
<li><strong>GdaÅ„sk:</strong> Gdansk: +13Â°C</li>
</ul>

    <h2>Kursy walut</h2>
    <ul><li><strong>USD:</strong> 3.72 PLN</li>
<li><strong>EUR:</strong> 4.28 PLN</li>
<li><strong>GBP:</strong> 4.98 PLN</li>
<li><strong>CHF:</strong> 4.59 PLN</li>
<li><strong>JPY:</strong> 0.03 PLN</li>
<li><strong>AUD:</strong> 2.39 PLN</li>
<li><strong>CAD:</strong> 2.69 PLN</li>
<li><strong>CNY:</strong> 0.51 PLN</li>
</ul>

    <h2>Tablica przeliczeÅ„</h2>
    <table>
      <tr><th></th><th>USD</th><th>EUR</th><th>GBP</th><th>CHF</th><th>JPY</th><th>AUD</th><th>CAD</th><th>CNY</th></tr>
      <tr><th>USD</th><td>1.0000</td><td>0.8696</td><td>0.7470</td><td>0.8106</td><td>140.5218</td><td>1.5605</td><td>1.3818</td><td>7.3138</td></tr>
<tr><th>EUR</th><td>1.1499</td><td>1.0000</td><td>0.8590</td><td>0.9321</td><td>161.5925</td><td>1.7945</td><td>1.5890</td><td>8.4105</td></tr>
<tr><th>GBP</th><td>1.3386</td><td>1.1641</td><td>1.0000</td><td>1.0850</td><td>188.1074</td><td>2.0890</td><td>1.8497</td><td>9.7905</td></tr>
<tr><th>CHF</th><td>1.2337</td><td>1.0728</td><td>0.9216</td><td>1.0000</td><td>173.3643</td><td>1.9252</td><td>1.7047</td><td>9.0232</td></tr>
<tr><th>JPY</th><td>0.0071</td><td>0.0062</td><td>0.0053</td><td>0.0058</td><td>1.0000</td><td>0.0111</td><td>0.0098</td><td>0.0520</td></tr>
<tr><th>AUD</th><td>0.6408</td><td>0.5573</td><td>0.4787</td><td>0.5194</td><td>90.0479</td><td>1.0000</td><td>0.8855</td><td>4.6868</td></tr>
<tr><th>CAD</th><td>0.7237</td><td>0.6293</td><td>0.5406</td><td>0.5866</td><td>101.6952</td><td>1.1293</td><td>1.0000</td><td>5.2930</td></tr>
<tr><th>CNY</th><td>0.1367</td><td>0.1189</td><td>0.1021</td><td>0.1108</td><td>19.2132</td><td>0.2134</td><td>0.1889</td><td>1.0000</td></tr>

    </table>

    <h2>Indeksy gieÅ‚dowe</h2>
    <ul></ul>

    <h2>SprawdÅº pogodÄ™</h2>
    <input id="city-input" placeholder="miasto"/><button id="city-btn">SprawdÅº</button>
    <p id="city-weather"></p>

    <h2>Mapa miast</h2>
    <div id="map" style="height:250px; margin-top:10px;"></div>

    <h2>Wykresy historii (7 dni)</h2>
    <canvas id="chart-temp" height="150"></canvas>
    <canvas id="chart-rates" height="150" style="margin-top:20px;"></canvas>

    <h2>Historia pomiarÃ³w co 5 minut</h2>
    <table>
      <tr><th>Data</th><th>Godzina</th><th>Pogoda</th><th>Kursy</th><th>Indeksy</th></tr>
      <tr><td>2025-04-22</td><td>19:49:49</td><td>Warsaw: +19Â°C<br>Krakow: +20Â°C<br>Gdansk: +13Â°C</td><td>USD: 3.72 | EUR: 4.28 | GBP: 4.98 | CHF: 4.59 | JPY: 0.03 | AUD: 2.39 | CAD: 2.69 | CNY: 0.51</td><td></td></tr>

    </table>
  </div>

  <script>
    // Dark mode toggle
    const btn = document.getElementById('toggle-dark');
    btn.onclick = () => { document.body.classList.toggle('dark'); localStorage.setItem('dark', document.body.classList.contains('dark')); };
    if (localStorage.getItem('dark') === 'true') { document.body.classList.add('dark'); }

    // Custom city weather
    document.getElementById('city-btn').onclick = async () => {
      const c = document.getElementById('city-input').value || 'Warsaw';
      const r = await fetch(`https://wttr.in/${c}?format=%l:+%t`);
      document.getElementById('city-weather').textContent = await r.text();
    };

    // Map
    const map = L.map('map').setView([52.23,21.01],6);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{ maxZoom:18 }).addTo(map);
    const today = {"timestamp": "2025-04-22 19:49:49", "date": "2025-04-22", "time": "19:49:49", "weather": {"Warsaw": "Warsaw: +19Â°C", "KrakÃ³w": "Krakow: +20Â°C", "GdaÅ„sk": "Gdansk: +13Â°C"}, "rates": {"USD": 3.722, "EUR": 4.2801, "GBP": 4.9824, "CHF": 4.5919, "JPY": 0.026487, "AUD": 2.3851, "CAD": 2.6936, "CNY": 0.5089}, "indices": {}};
    const coords = {"Warsaw": [52.23, 21.01], "Krak\u00f3w": [50.06, 19.94], "Gda\u0144sk": [54.35, 18.65]};
    Object.entries(coords).forEach(([city,c]) => { 
      L.marker(c).addTo(map)
       .bindPopup(`<strong>${city}:</strong> ${today.weather[city]}`);
    });

    // Charts with history
    const history = [{"timestamp": "2025-04-22 19:49:49", "date": "2025-04-22", "time": "19:49:49", "weather": {"Warsaw": "Warsaw: +19Â°C", "KrakÃ³w": "Krakow: +20Â°C", "GdaÅ„sk": "Gdansk: +13Â°C"}, "rates": {"USD": 3.722, "EUR": 4.2801, "GBP": 4.9824, "CHF": 4.5919, "JPY": 0.026487, "AUD": 2.3851, "CAD": 2.6936, "CNY": 0.5089}, "indices": {}}];
    const labels = history.map(d => d.timestamp);
    const tempDatasets = Object.keys(history[0].weather).map(city => ({
      label: city,
      data: history.map(d => parseInt(d.weather[city].match(/[-+]\d+/)[0])),
      fill: false, tension: 0.3
    }));
    new Chart(document.getElementById('chart-temp'), { type:'line', data:{ labels, datasets: tempDatasets } });
    const rateDatasets = Object.keys(history[0].rates).map(cur => ({
      label: cur,
      data: history.map(d => d.rates[cur] || null),
      fill: false, tension: 0.3
    }));
    new Chart(document.getElementById('chart-rates'), { type:'line', data:{ labels, datasets: rateDatasets } });
  </script>
</body>
</html>
